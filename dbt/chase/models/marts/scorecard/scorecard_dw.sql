{{
  config(
    materialized = 'table'
    )
}}
SELECT 
    acceptpct,
    acceptsreferralfees,
    acceptsreferralsonsaturdays,
    acceptsreferralsonsundays,
    activereferrals,
    additionalnotes,
    address,
    agent_name,
    agentacceptcount,
    agentaggregateid,
    agentctccount,
    agentfirstname,
    agentid,
    agentlastname,
    agentoffercount,
    agentrejectcount,
    agentrole,
    agentstatuscount,
    agenttimeoutcount,
    fas.aggregate_id,
    assignee_aggregate_id,
    bio,
    brokerage,
    brokerage_email,
    brokerage_name,
    brokerage_phone,
    brokeragecode,
    buyerpct,
    cae_legacy_agent,
    caelegacyagent,
    closedreferrals,
    closedreferrals_over90days,
    closepct,
    closinghours,
    cognitousername,
    comment,
    comments,
    coveredareas,
    coveredzips,
    created,
    currentreferrals,
    currentreferrals_acceptedlast30days,
    currentreferrals_acceptedlast90days,
    currentreferrals_over90days,
    description,
    divisionmanager,
    divisionname,
    eligibilitystatus,
    email,
    experienceyears,
    first_name,
    firstonboardingstep,
    fthbpct,
    hla_invited_agent,
    hla_name,
    hlaagregateid,
    hlaemail,
    hlafirstname,
    hlaid,
    hlaidcheck,
    hlalastname,
    hlanmlsid,
    hlaphone,
    hlarole,
    id,
    imagelink,
    inactivereferrals,
    ineligiblecomment,
    inviter_email,
    inviter_firstname,
    inviter_lastname,
    l30_acceptpct,
    l30_responsepct,
    l30_timeoutpct,
    l90_acceptpct,
    l90_responsepct,
    l90_timeoutpct,
    languagecount,
    languages,
    last30days_agentacceptcount,
    last30days_agentctccount,
    last30days_agentoffercount,
    last30days_agentrejectcount,
    last30days_agentstatuscount,
    last30days_agenttimeoutcount,
    last30days_updates_in_compliance,
    last90days_agentacceptcount,
    last90days_agentctccount,
    last90days_agentoffercount,
    last90days_agentrejectcount,
    last90days_agentstatuscount,
    last90days_agenttimeoutcount,
    last90days_updates_in_compliance,
    last_name,
    lmemail,
    lmfirstname,
    lmid,
    lmidcheck,
    lmlastname,
    localtimezone,
    luxpct,
    mls,
    networkrequirements,
    newpct,
    nmlsid,
    office,
    offices,
    oldzipcount,
    onholdreferrals,
    openinghours,
    pendingreferrals,
    percentage_fee,
    phones,
    productioninput,
    productiontotalunits,
    profileinfo,
    program_name,
    realestatestartdate,
    reasonfordeactivation,
    reasonforremoval,
    receivesreferralsviatextmessage,
    referral_fee_category_id,
    referralagreementemail,
    referralcount,
    removalreason,
    responsepct,
    sellerpct,
    slmemail,
    slmfirstname,
    slmid,
    slmlastname,
    standardsaccepted,
    statelicenseexpiration,
    statelicenses,
    termsandconditions,
    timeoutpct,
    trainingcomp,
    trainingcompleted,
    unavailabledates,
    units,
    unverfiedprofilesections,
    unverifiedprofilesections,
    updated,
    updates_in_compliance,
    verification_status,
    verificationinputfieldsinprogress,
    verificationstatus,
    volume,
    workinghours,
    zipcount
FROM
    {{ ref('fct_agent_scorecard') }} fas
LEFT JOIN {{ ref('agent_profiles') }} ap
ON fas.aggregate_id=ap.aggregate_id
LEFT JOIN {{ ref('referral_fee') }} rf
ON fas.aggregate_id=rf.assignee_aggregate_id