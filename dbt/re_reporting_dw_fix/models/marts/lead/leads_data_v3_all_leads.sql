{{
  config(
    materialized = 'table'
    )
}}
with union_cte AS (
select 
accept_time_delay_hrs,
accept_to_contact_delay,
actively_searching_status_time,
agent_aggregate_id,
agent_assign_time,
agent_assign_time_unadjusted,
agent_assigned,
agent_email,
agent_name,
agent_phone,
agent_status,
agent_status_time,
agent_submitted,
agentassign_time_delay_hrs,
agentfirstname,
agentlastname,
attached,
attachment,
attachment_code,
attachment_reason,
avg_price,
bank_id,
bank_name,
brokerage_code,
brokerageroutingmethod,
businesshours,
category,
citizenssalesforceenrollment,
city,
client_contact_approval,
client_email,
client_first_name,
client_last_name,
client_name,
client_phone,
closeaddress,
closedate,
comments,
consumer_confirmed,
contactmethod,
coverage,
created,
cst,
cstdate,
csthour,
current_location,
date,
date_marked_closed_final,
date_part,
dow,
escalatedtoconcierge,
failc,
faild,
financeclosedate,
first_agent_contact_time,
first_contact_delay_from_enrollment,
first_contact_time,
first_time_wh,
full_name,
hb_status,
hb_status_time,
homesaleprice,
id,
inactivedate,
inactiverole,
last_agent_update,
last_rc_update,
lastpendingdate,
lenderclosedwith,
level_1_manager,
level_1_manager_email,
level_3_manager_email,
level_3_manager_name,
level_3_manager_region,
level_4_manager_region,
lo_aggregate_id,
lo_email,
lo_email_final,
lo_first_name,
lo_last_name,
lo_name,
lo_nmlsid,
lo_phone,
lsuclosedate,
major_status,
mlo_assign_time,
mlo_status,
mlo_status_time,
mlosubmission,
mnth_yr,
networkid,
nmlsid,
normalizedclosedate,
outofnetwork,
pending,
pending_status_time,
pendingclosedate,
pendingpropertyaddress,
ph_bank_name,
ph_dd_division,
ph_dd_email,
ph_dd_name,
ph_lm_email,
ph_lm_name,
ph_lo_email,
ph_slm_manager,
ph_slm_name,
prequal,
price_range_lower_bound,
price_range_upper_bound,
propertyaddress,
propertyprice,
purchase_location,
purchase_time_frame,
rc_accept_time_unadjusted,
rc_city,
rc_contact_first,
rc_contact_last,
rc_email,
rc_mobile_phone,
rc_name,
rc_office_phone,
rc_phone,
rc_state,
rc_status,
rc_status_time,
reporting_enroll_date,
reporting_invite_date,
sell_location,
selling_address,
source,
state,
system_enroll_date,
system_invite_date,
timetoinactive,
traffic_campaign,
traffic_medium,
transaction_type,
type_of_load_wh,
updated_at,
updated_in_wh,
weeknum,
year,
zip,
agtcommpct::text as agtcommpct,
bankcustomer::text as bankcustomer,
branchemployee::text as branchemployee,
branchname::text as branchname,
customereci::text as customereci,
outofnetworkbrokerage::text as outofnetworkbrokerage,
velocifyid::text as velocifyid,
partner_internal_id
FROM {{ ref('leads_data_v3') }}
UNION
select 
    accept_time_delay_hrs,
accept_to_contact_delay,
actively_searching_status_time,
agent_aggregate_id,
agent_assign_time,
agent_assign_time_unadjusted,
agent_assigned,
agent_email,
agent_name,
agent_phone,
agent_status,
agent_status_time,
agent_submitted,
agentassign_time_delay_hrs,
agentfirstname,
agentlastname,
attached,
attachment,
attachment_code,
attachment_reason,
avg_price,
bank_id,
bank_name,
brokerage_code,
brokerageroutingmethod,
businesshours,
category,
citizenssalesforceenrollment,
city,
client_contact_approval,
client_email,
client_first_name,
client_last_name,
client_name,
client_phone,
closeaddress,
closedate,
comments,
consumer_confirmed,
contactmethod,
coverage,
created,
cst,
cstdate,
csthour,
current_location,
date,
date_marked_closed_final,
date_part,
dow,
escalatedtoconcierge,
failc,
faild,
financeclosedate,
first_agent_contact_time,
first_contact_delay_from_enrollment,
first_contact_time,
first_time_wh,
full_name,
hb_status,
hb_status_time,
homesaleprice,
id,
inactivedate,
inactiverole,
last_agent_update,
last_rc_update,
lastpendingdate,
lenderclosedwith,
level_1_manager,
level_1_manager_email,
level_3_manager_email,
level_3_manager_name,
level_3_manager_region,
level_4_manager_region,
lo_aggregate_id,
lo_email,
lo_email_final,
lo_first_name,
lo_last_name,
lo_name,
lo_nmlsid,
lo_phone,
lsuclosedate,
major_status,
mlo_assign_time,
mlo_status,
mlo_status_time,
mlosubmission,
mnth_yr,
networkid,
nmlsid,
normalizedclosedate,
outofnetwork,
pending,
pending_status_time,
pendingclosedate,
pendingpropertyaddress,
ph_bank_name,
ph_dd_division,
ph_dd_email,
ph_dd_name,
ph_lm_email,
ph_lm_name,
ph_lo_email,
ph_slm_manager,
ph_slm_name,
prequal,
price_range_lower_bound,
price_range_upper_bound,
propertyaddress,
propertyprice,
purchase_location,
purchase_time_frame,
rc_accept_time_unadjusted,
rc_city,
rc_contact_first,
rc_contact_last,
rc_email,
rc_mobile_phone,
rc_name,
rc_office_phone,
rc_phone,
rc_state,
rc_status,
rc_status_time,
reporting_enroll_date,
reporting_invite_date,
sell_location,
selling_address,
source,
state,
system_enroll_date,
system_invite_date,
timetoinactive,
traffic_campaign,
traffic_medium,
transaction_type,
type_of_load_wh,
updated_at,
updated_in_wh,
weeknum,
year,
zip,
agtcommpct::text AS agtcommpct,
bankcustomer::text as bankcustomer,
branchemployee::text as branchemployee,
branchname::text as branchname,
customereci::text as customereci,
outofnetworkbrokerage::text as outofnetworkbrokerage,
velocifyid::text as velocifyid,
partner_internal_id
FROM {{ ref('leads_data_v3_agent_submitted') }}
)
select 
accept_time_delay_hrs,
accept_to_contact_delay,
actively_searching_status_time,
agent_aggregate_id,
agent_assign_time,
agent_assign_time_unadjusted,
agent_assigned,
agent_email,
agent_name,
agent_phone,
agent_status,
agent_status_time,
agent_submitted,
agentassign_time_delay_hrs,
agentfirstname,
agentlastname,
attached,
attachment,
attachment_code,
attachment_reason,
avg_price,
bank_id,
bank_name,
brokerage_code,
brokerageroutingmethod,
businesshours,
category,
citizenssalesforceenrollment,
city,
client_contact_approval,
client_email,
client_first_name,
client_last_name,
client_name,
client_phone,
closeaddress,
closedate,
comments,
consumer_confirmed,
contactmethod,
coverage,
created,
cst,
cstdate,
csthour,
current_location,
date,
date_marked_closed_final,
date_part,
dow,
escalatedtoconcierge,
failc,
faild,
financeclosedate,
first_agent_contact_time,
first_contact_delay_from_enrollment,
first_contact_time,
first_time_wh,
full_name,
hb_status,
hb_status_time,
homesaleprice,
id,
inactivedate,
inactiverole,
last_agent_update,
last_rc_update,
lastpendingdate,
lenderclosedwith,
level_1_manager,
level_1_manager_email,
level_3_manager_email,
level_3_manager_name,
level_3_manager_region,
level_4_manager_region,
lo_aggregate_id,
lo_email,
lo_email_final,
lo_first_name,
lo_last_name,
lo_name,
lo_nmlsid,
lo_phone,
lsuclosedate,
major_status,
mlo_assign_time,
mlo_status,
mlo_status_time,
mlosubmission,
mnth_yr,
networkid,
nmlsid,
normalizedclosedate,
outofnetwork,
pending,
pending_status_time,
pendingclosedate,
pendingpropertyaddress,
ph_bank_name,
ph_dd_division,
ph_dd_email,
ph_dd_name,
ph_lm_email,
ph_lm_name,
ph_lo_email,
ph_slm_manager,
ph_slm_name,
prequal,
price_range_lower_bound,
price_range_upper_bound,
propertyaddress,
propertyprice,
purchase_location,
purchase_time_frame,
rc_accept_time_unadjusted,
rc_city,
rc_contact_first,
rc_contact_last,
rc_email,
rc_mobile_phone,
rc_name,
rc_office_phone,
rc_phone,
rc_state,
rc_status,
rc_status_time,
reporting_enroll_date,
reporting_invite_date,
sell_location,
selling_address,
source,
state,
system_enroll_date,
system_invite_date,
timetoinactive,
traffic_campaign,
traffic_medium,
transaction_type,
type_of_load_wh,
updated_at,
updated_in_wh,
weeknum,
year,
{% if target.type == 'snowflake' %}
agtcommpct::variant as agtcommpct,
bankcustomer::variant as bankcustomer,
branchname::variant as branchname,
customereci::variant as customereci,
outofnetworkbrokerage::variant as outofnetworkbrokerage,
velocifyid::variant as velocifyid,
{% else %}
agtcommpct::json as agtcommpct,
bankcustomer::json as bankcustomer,
branchemployee::json as branchemployee,
branchname::json as branchname,
customereci::json as customereci,
outofnetworkbrokerage::json as outofnetworkbrokerage,
velocifyid::json as velocifyid,
{% endif %}
zip,
partner_internal_id
from union_cte